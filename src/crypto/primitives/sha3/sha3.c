/*
 * Copyright (c) 2013-2025 Ryan Vogt <rvogt.ca@gmail.com>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#include "sha3.h"

#include "common/bytetype.h"
#include "common/errorflow.h"
#include "common/scrub.h"
#include "crypto/machine/endian.h"

#include <stddef.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>

#define MIN(a, b) ((a) < (b) ? (a) : (b))

struct sha3_ctx {
    uint64_t state[25];
    byte leftover[SHA3_BLOCK_BYTES_MAX];
    size_t amnt_leftover;
    size_t rate;
    size_t output_size;
};

/*
 * The Keccak-f function is defined in FIPS 202. This implementation is
 * algorithmically generated.
 */
static void keccak_f(struct sha3_ctx *ctx, const byte *new_data);

struct sha3_ctx *sha3_alloc(void)
{
    struct sha3_ctx *ret =
        (struct sha3_ctx *)calloc(1, sizeof(struct sha3_ctx));
    GUARD_ALLOC(ret);
    return ret;
}

void sha3_224_start(struct sha3_ctx *ctx)
{
    memset(ctx, 0, sizeof(struct sha3_ctx));
    ctx->rate = SHA3_224_BLOCK_BYTES;
    ctx->output_size = SHA3_224_DIGEST_BYTES;
}

void sha3_256_start(struct sha3_ctx *ctx)
{
    memset(ctx, 0, sizeof(struct sha3_ctx));
    ctx->rate = SHA3_256_BLOCK_BYTES;
    ctx->output_size = SHA3_256_DIGEST_BYTES;
}

void sha3_384_start(struct sha3_ctx *ctx)
{
    memset(ctx, 0, sizeof(struct sha3_ctx));
    ctx->rate = SHA3_384_BLOCK_BYTES;
    ctx->output_size = SHA3_384_DIGEST_BYTES;
}

void sha3_512_start(struct sha3_ctx *ctx)
{
    memset(ctx, 0, sizeof(struct sha3_ctx));
    ctx->rate = SHA3_512_BLOCK_BYTES;
    ctx->output_size = SHA3_512_DIGEST_BYTES;
}

void sha3_add(struct sha3_ctx *ctx, const byte *bytes, size_t num_bytes)
{
    size_t to_copy, on_byte;

    /* Deal with any leftover bytes first */
    on_byte = 0;
    if (ctx->amnt_leftover) {
        to_copy = ctx->rate - ctx->amnt_leftover;
        if (to_copy > num_bytes) {
            to_copy = num_bytes;
        }
        memcpy(ctx->leftover + ctx->amnt_leftover, bytes, to_copy);
        ctx->amnt_leftover += to_copy;
        if (ctx->amnt_leftover == ctx->rate) {
            keccak_f(ctx, ctx->leftover);
            ctx->amnt_leftover = 0;
        }
        on_byte = to_copy;
    }

    /* Process as many full-rate blocks as possible */
    while (num_bytes - on_byte >= ctx->rate) {
        keccak_f(ctx, bytes + on_byte);
        on_byte += ctx->rate;
    }

    /* Store any leftover */
    if (num_bytes - on_byte) {
        memcpy(ctx->leftover, bytes + on_byte, num_bytes - on_byte);
        ctx->amnt_leftover = num_bytes - on_byte;
    }
}

void sha3_end(struct sha3_ctx *ctx, byte *digest)
{
    size_t bytes_needed, to_copy, i;
    byte output[8];

    /*
     * Padding at the end of the message. The original Keccak specification set
     * the the first byte after the message to 0x01; the SHA-3 specification
     * uses 0x06 to differentiate it (equivalent to appending bits "01" to the
     * end of the message before beginning the 100...01 pad).
     */
    memset(ctx->leftover + ctx->amnt_leftover, 0,
           ctx->rate - ctx->amnt_leftover);
    ctx->leftover[ctx->amnt_leftover] = 0x06;
    ctx->leftover[ctx->rate - 1] |= 0x80;
    keccak_f(ctx, ctx->leftover);

    /*
     * Take rate bytes at a time from the state. In this implementation, rate
     * is guaranteed to be larger than output length, so this is simple.
     */
    bytes_needed = ctx->output_size;
    i = 0;
    while (bytes_needed) {
        put_little_end_64(output, ctx->state[i++]);
        to_copy = MIN(bytes_needed, 8);
        memcpy(digest, output, to_copy);
        digest += to_copy;
        bytes_needed -= to_copy;
    }
}

void sha3_copy(struct sha3_ctx *dst, const struct sha3_ctx *src)
{
    memcpy(dst, src, sizeof(struct sha3_ctx));
}

void sha3_free_scrub(struct sha3_ctx *ctx)
{
    if (ctx != NULL) {
        scrub_memory(ctx, sizeof(struct sha3_ctx));
        free(ctx);
    }
}

static void keccak_f(struct sha3_ctx *ctx, const byte *new_data)
{
    uint64_t *a;
    uint64_t b[25];
    uint64_t c[5];
    uint64_t d[5];
    uint64_t i;
    a = ctx->state;
    for (i = 0; i < ctx->rate / 8; i++) {
        a[i] ^= get_little_end_64(new_data + 8 * i);
    }
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x0000000000000001ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x0000000000008082ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x800000000000808AULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000080008000ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x000000000000808BULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x0000000080000001ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000080008081ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000000008009ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x000000000000008AULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x0000000000000088ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x0000000080008009ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x000000008000000AULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x000000008000808BULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x800000000000008BULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000000008089ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000000008003ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000000008002ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000000000080ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x000000000000800AULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x800000008000000AULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000080008081ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000000008080ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x0000000080000001ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
    c[0] = a[0] ^ a[5] ^ a[10] ^ a[15] ^ a[20];
    c[1] = a[1] ^ a[6] ^ a[11] ^ a[16] ^ a[21];
    c[2] = a[2] ^ a[7] ^ a[12] ^ a[17] ^ a[22];
    c[3] = a[3] ^ a[8] ^ a[13] ^ a[18] ^ a[23];
    c[4] = a[4] ^ a[9] ^ a[14] ^ a[19] ^ a[24];
    d[0] = c[4] ^ ((c[1] << 1) | (c[1] >> 63));
    d[1] = c[0] ^ ((c[2] << 1) | (c[2] >> 63));
    d[2] = c[1] ^ ((c[3] << 1) | (c[3] >> 63));
    d[3] = c[2] ^ ((c[4] << 1) | (c[4] >> 63));
    d[4] = c[3] ^ ((c[0] << 1) | (c[0] >> 63));
    a[0] ^= d[0];
    a[5] ^= d[0];
    a[10] ^= d[0];
    a[15] ^= d[0];
    a[20] ^= d[0];
    a[1] ^= d[1];
    a[6] ^= d[1];
    a[11] ^= d[1];
    a[16] ^= d[1];
    a[21] ^= d[1];
    a[2] ^= d[2];
    a[7] ^= d[2];
    a[12] ^= d[2];
    a[17] ^= d[2];
    a[22] ^= d[2];
    a[3] ^= d[3];
    a[8] ^= d[3];
    a[13] ^= d[3];
    a[18] ^= d[3];
    a[23] ^= d[3];
    a[4] ^= d[4];
    a[9] ^= d[4];
    a[14] ^= d[4];
    a[19] ^= d[4];
    a[24] ^= d[4];
    b[0] = a[0];
    b[16] = ((a[5] << 36) | (a[5] >> 28));
    b[7] = ((a[10] << 3) | (a[10] >> 61));
    b[23] = ((a[15] << 41) | (a[15] >> 23));
    b[14] = ((a[20] << 18) | (a[20] >> 46));
    b[10] = ((a[1] << 1) | (a[1] >> 63));
    b[1] = ((a[6] << 44) | (a[6] >> 20));
    b[17] = ((a[11] << 10) | (a[11] >> 54));
    b[8] = ((a[16] << 45) | (a[16] >> 19));
    b[24] = ((a[21] << 2) | (a[21] >> 62));
    b[20] = ((a[2] << 62) | (a[2] >> 2));
    b[11] = ((a[7] << 6) | (a[7] >> 58));
    b[2] = ((a[12] << 43) | (a[12] >> 21));
    b[18] = ((a[17] << 15) | (a[17] >> 49));
    b[9] = ((a[22] << 61) | (a[22] >> 3));
    b[5] = ((a[3] << 28) | (a[3] >> 36));
    b[21] = ((a[8] << 55) | (a[8] >> 9));
    b[12] = ((a[13] << 25) | (a[13] >> 39));
    b[3] = ((a[18] << 21) | (a[18] >> 43));
    b[19] = ((a[23] << 56) | (a[23] >> 8));
    b[15] = ((a[4] << 27) | (a[4] >> 37));
    b[6] = ((a[9] << 20) | (a[9] >> 44));
    b[22] = ((a[14] << 39) | (a[14] >> 25));
    b[13] = ((a[19] << 8) | (a[19] >> 56));
    b[4] = ((a[24] << 14) | (a[24] >> 50));
    a[0] = b[0] ^ ((~b[1]) & b[2]) ^ 0x8000000080008008ULL;
    a[5] = b[5] ^ ((~b[6]) & b[7]);
    a[10] = b[10] ^ ((~b[11]) & b[12]);
    a[15] = b[15] ^ ((~b[16]) & b[17]);
    a[20] = b[20] ^ ((~b[21]) & b[22]);
    a[1] = b[1] ^ ((~b[2]) & b[3]);
    a[6] = b[6] ^ ((~b[7]) & b[8]);
    a[11] = b[11] ^ ((~b[12]) & b[13]);
    a[16] = b[16] ^ ((~b[17]) & b[18]);
    a[21] = b[21] ^ ((~b[22]) & b[23]);
    a[2] = b[2] ^ ((~b[3]) & b[4]);
    a[7] = b[7] ^ ((~b[8]) & b[9]);
    a[12] = b[12] ^ ((~b[13]) & b[14]);
    a[17] = b[17] ^ ((~b[18]) & b[19]);
    a[22] = b[22] ^ ((~b[23]) & b[24]);
    a[3] = b[3] ^ ((~b[4]) & b[0]);
    a[8] = b[8] ^ ((~b[9]) & b[5]);
    a[13] = b[13] ^ ((~b[14]) & b[10]);
    a[18] = b[18] ^ ((~b[19]) & b[15]);
    a[23] = b[23] ^ ((~b[24]) & b[20]);
    a[4] = b[4] ^ ((~b[0]) & b[1]);
    a[9] = b[9] ^ ((~b[5]) & b[6]);
    a[14] = b[14] ^ ((~b[10]) & b[11]);
    a[19] = b[19] ^ ((~b[15]) & b[16]);
    a[24] = b[24] ^ ((~b[20]) & b[21]);
}
