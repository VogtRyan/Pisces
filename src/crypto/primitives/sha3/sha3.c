/*
 * Copyright (c) 2013-2025 Ryan Vogt <rvogt.ca@gmail.com>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#include "sha3.h"

#include "common/bytetype.h"
#include "common/errorflow.h"
#include "common/scrub.h"
#include "crypto/machine/endian.h"

#include <stddef.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>

struct sha3_ctx {
    uint64_t state[25];
    byte leftover[SHA3_BLOCK_BYTES_MAX];
    size_t amntLeftover;
    size_t rate;
    size_t outputSize;
};

/*
 * Compute the Keccak-f function on the given data, as defined in FIPS 202.
 * Note that the keccak_f() function is algorithmically generated.
 */
static void keccak_f(struct sha3_ctx *ctx, const byte *newData);

struct sha3_ctx *sha3_alloc(void)
{
    struct sha3_ctx *ret =
        (struct sha3_ctx *)calloc(1, sizeof(struct sha3_ctx));
    GUARD_ALLOC(ret);
    return ret;
}

void sha3_224_start(struct sha3_ctx *ctx)
{
    memset(ctx, 0, sizeof(struct sha3_ctx));
    ctx->rate = SHA3_224_BLOCK_BYTES;
    ctx->outputSize = SHA3_224_DIGEST_BYTES;
}

void sha3_256_start(struct sha3_ctx *ctx)
{
    memset(ctx, 0, sizeof(struct sha3_ctx));
    ctx->rate = SHA3_256_BLOCK_BYTES;
    ctx->outputSize = SHA3_256_DIGEST_BYTES;
}

void sha3_384_start(struct sha3_ctx *ctx)
{
    memset(ctx, 0, sizeof(struct sha3_ctx));
    ctx->rate = SHA3_384_BLOCK_BYTES;
    ctx->outputSize = SHA3_384_DIGEST_BYTES;
}

void sha3_512_start(struct sha3_ctx *ctx)
{
    memset(ctx, 0, sizeof(struct sha3_ctx));
    ctx->rate = SHA3_512_BLOCK_BYTES;
    ctx->outputSize = SHA3_512_DIGEST_BYTES;
}

void sha3_add(struct sha3_ctx *ctx, const byte *bytes, size_t numBytes)
{
    size_t toCopy, onByte;

    /* Deal with any leftover bytes first */
    onByte = 0;
    if (ctx->amntLeftover) {
        toCopy = ctx->rate - ctx->amntLeftover;
        if (toCopy > numBytes) {
            toCopy = numBytes;
        }
        memcpy(ctx->leftover + ctx->amntLeftover, bytes, toCopy);
        ctx->amntLeftover += toCopy;
        if (ctx->amntLeftover == ctx->rate) {
            keccak_f(ctx, ctx->leftover);
            ctx->amntLeftover = 0;
        }
        onByte = toCopy;
    }

    /* Process as many full-rate blocks as possible */
    while (numBytes - onByte >= ctx->rate) {
        keccak_f(ctx, bytes + onByte);
        onByte += ctx->rate;
    }

    /* Store any leftover */
    if (numBytes - onByte) {
        memcpy(ctx->leftover, bytes + onByte, numBytes - onByte);
        ctx->amntLeftover = numBytes - onByte;
    }
}

void sha3_end(struct sha3_ctx *ctx, byte *digest)
{
    size_t bytesNeeded, toCopy, i;
    byte output[8];

    /*
     * Padding at the end of the message. The original Keccak specification set
     * the the first byte after the message to 0x01; the SHA-3 specification
     * uses 0x06 to differentiate it (equivalent to appending bits "01" to the
     * end of the message before beginning the 100...01 pad).
     */
    memset(ctx->leftover + ctx->amntLeftover, 0,
           ctx->rate - ctx->amntLeftover);
    ctx->leftover[ctx->amntLeftover] = 0x06;
    ctx->leftover[ctx->rate - 1] |= 0x80;
    keccak_f(ctx, ctx->leftover);

    /*
     * Take rate bytes at a time from the state.  In this implementation, rate
     * is guaranteed to be larger than output length, so this is simple.
     */
    bytesNeeded = ctx->outputSize;
    i = 0;
    while (bytesNeeded) {
        put_little_end_64(output, ctx->state[i++]);
        toCopy = (bytesNeeded < 8 ? bytesNeeded : 8);
        memcpy(digest, output, toCopy);
        digest += toCopy;
        bytesNeeded -= toCopy;
    }
}

void sha3_copy(struct sha3_ctx *dst, const struct sha3_ctx *src)
{
    memcpy(dst, src, sizeof(struct sha3_ctx));
}

void sha3_free_scrub(struct sha3_ctx *ctx)
{
    if (ctx != NULL) {
        scrub_memory(ctx, sizeof(struct sha3_ctx));
        free(ctx);
    }
}

static void keccak_f(struct sha3_ctx *ctx, const byte *newData)
{
    uint64_t *A;
    uint64_t B[25];
    uint64_t C[5];
    uint64_t D[5];
    uint64_t i;
    A = ctx->state;
    for (i = 0; i < ctx->rate / 8; i++) {
        A[i] ^= get_little_end_64(newData + 8 * i);
    }
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x0000000000000001ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x0000000000008082ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x800000000000808AULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000080008000ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x000000000000808BULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x0000000080000001ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000080008081ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000000008009ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x000000000000008AULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x0000000000000088ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x0000000080008009ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x000000008000000AULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x000000008000808BULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x800000000000008BULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000000008089ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000000008003ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000000008002ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000000000080ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x000000000000800AULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x800000008000000AULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000080008081ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000000008080ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x0000000080000001ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
    C[0] = A[0] ^ A[5] ^ A[10] ^ A[15] ^ A[20];
    C[1] = A[1] ^ A[6] ^ A[11] ^ A[16] ^ A[21];
    C[2] = A[2] ^ A[7] ^ A[12] ^ A[17] ^ A[22];
    C[3] = A[3] ^ A[8] ^ A[13] ^ A[18] ^ A[23];
    C[4] = A[4] ^ A[9] ^ A[14] ^ A[19] ^ A[24];
    D[0] = C[4] ^ ((C[1] << 1) | (C[1] >> 63));
    D[1] = C[0] ^ ((C[2] << 1) | (C[2] >> 63));
    D[2] = C[1] ^ ((C[3] << 1) | (C[3] >> 63));
    D[3] = C[2] ^ ((C[4] << 1) | (C[4] >> 63));
    D[4] = C[3] ^ ((C[0] << 1) | (C[0] >> 63));
    A[0] ^= D[0];
    A[5] ^= D[0];
    A[10] ^= D[0];
    A[15] ^= D[0];
    A[20] ^= D[0];
    A[1] ^= D[1];
    A[6] ^= D[1];
    A[11] ^= D[1];
    A[16] ^= D[1];
    A[21] ^= D[1];
    A[2] ^= D[2];
    A[7] ^= D[2];
    A[12] ^= D[2];
    A[17] ^= D[2];
    A[22] ^= D[2];
    A[3] ^= D[3];
    A[8] ^= D[3];
    A[13] ^= D[3];
    A[18] ^= D[3];
    A[23] ^= D[3];
    A[4] ^= D[4];
    A[9] ^= D[4];
    A[14] ^= D[4];
    A[19] ^= D[4];
    A[24] ^= D[4];
    B[0] = A[0];
    B[16] = ((A[5] << 36) | (A[5] >> 28));
    B[7] = ((A[10] << 3) | (A[10] >> 61));
    B[23] = ((A[15] << 41) | (A[15] >> 23));
    B[14] = ((A[20] << 18) | (A[20] >> 46));
    B[10] = ((A[1] << 1) | (A[1] >> 63));
    B[1] = ((A[6] << 44) | (A[6] >> 20));
    B[17] = ((A[11] << 10) | (A[11] >> 54));
    B[8] = ((A[16] << 45) | (A[16] >> 19));
    B[24] = ((A[21] << 2) | (A[21] >> 62));
    B[20] = ((A[2] << 62) | (A[2] >> 2));
    B[11] = ((A[7] << 6) | (A[7] >> 58));
    B[2] = ((A[12] << 43) | (A[12] >> 21));
    B[18] = ((A[17] << 15) | (A[17] >> 49));
    B[9] = ((A[22] << 61) | (A[22] >> 3));
    B[5] = ((A[3] << 28) | (A[3] >> 36));
    B[21] = ((A[8] << 55) | (A[8] >> 9));
    B[12] = ((A[13] << 25) | (A[13] >> 39));
    B[3] = ((A[18] << 21) | (A[18] >> 43));
    B[19] = ((A[23] << 56) | (A[23] >> 8));
    B[15] = ((A[4] << 27) | (A[4] >> 37));
    B[6] = ((A[9] << 20) | (A[9] >> 44));
    B[22] = ((A[14] << 39) | (A[14] >> 25));
    B[13] = ((A[19] << 8) | (A[19] >> 56));
    B[4] = ((A[24] << 14) | (A[24] >> 50));
    A[0] = B[0] ^ ((~B[1]) & B[2]) ^ 0x8000000080008008ULL;
    A[5] = B[5] ^ ((~B[6]) & B[7]);
    A[10] = B[10] ^ ((~B[11]) & B[12]);
    A[15] = B[15] ^ ((~B[16]) & B[17]);
    A[20] = B[20] ^ ((~B[21]) & B[22]);
    A[1] = B[1] ^ ((~B[2]) & B[3]);
    A[6] = B[6] ^ ((~B[7]) & B[8]);
    A[11] = B[11] ^ ((~B[12]) & B[13]);
    A[16] = B[16] ^ ((~B[17]) & B[18]);
    A[21] = B[21] ^ ((~B[22]) & B[23]);
    A[2] = B[2] ^ ((~B[3]) & B[4]);
    A[7] = B[7] ^ ((~B[8]) & B[9]);
    A[12] = B[12] ^ ((~B[13]) & B[14]);
    A[17] = B[17] ^ ((~B[18]) & B[19]);
    A[22] = B[22] ^ ((~B[23]) & B[24]);
    A[3] = B[3] ^ ((~B[4]) & B[0]);
    A[8] = B[8] ^ ((~B[9]) & B[5]);
    A[13] = B[13] ^ ((~B[14]) & B[10]);
    A[18] = B[18] ^ ((~B[19]) & B[15]);
    A[23] = B[23] ^ ((~B[24]) & B[20]);
    A[4] = B[4] ^ ((~B[0]) & B[1]);
    A[9] = B[9] ^ ((~B[5]) & B[6]);
    A[14] = B[14] ^ ((~B[10]) & B[11]);
    A[19] = B[19] ^ ((~B[15]) & B[16]);
    A[24] = B[24] ^ ((~B[20]) & B[21]);
}
